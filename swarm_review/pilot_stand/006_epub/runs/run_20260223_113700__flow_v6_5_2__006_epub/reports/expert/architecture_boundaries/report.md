# Expert Report: architecture_boundaries

Agent: `019c89a6-74fc-7fa2-b574-b3822fef28de`

| # | Title | Severity | Evidence | Remediation |
|---|---|---|---|---|
| 1 | UI layer directly performs destructive schema operations | P0 | `bot/handlers/common.py:18`, `bot/handlers/common.py:447`, `bot/handlers/common.py:543`, `bot/handlers/common.py:556`, `bot/handlers/common.py:568` | Move DB reset/drop logic to a dedicated admin service/CLI module; keep Telegram handlers as thin orchestrators calling that service behind strict authorization and environment gates. |
| 2 | Duplicate Back-to-Library flow is active in two routers | P1 | `main.py:203`, `main.py:204`, `bot/handlers/common.py:654`, `bot/handlers/navigation_reloaded.py:111`, `bot/handlers/common.py:101`, `bot/handlers/navigation_reloaded.py:37` | Keep one canonical library navigation handler and one library-page builder; remove duplicate router registration and extract shared behavior into a single `LibraryPageService`. |
| 3 | Navigation router wiring has import-time side effects and mixed composition ownership | P1 | `bot/handlers/navigation/router.py:45`, `bot/handlers/navigation/router.py:65`, `bot/handlers/navigation/__init__.py:51`, `bot/handlers/navigation/__init__.py:53`, `main.py:204` | Remove `setup_navigation_routers()` execution at import time; wire subrouters only in one explicit composition root (startup/bootstrap). |
| 4 | `bot.handlers.navigation` acts as a service locator, creating high coupling and wrapper duplication | P1 | `bot/handlers/navigation/__init__.py:13`, `bot/handlers/navigation/__init__.py:39`, `bot/handlers/navigation/__init__.py:126`, `bot/handlers/navigation/summary/request.py:16`, `bot/handlers/navigation/summary/request.py:185`, `bot/handlers/navigation/translation/pipeline.py:13`, `bot/handlers/navigation/translation/pipeline.py:46` | Replace `nav.*` proxy wrappers with explicit imports or injected dependencies per module; split `navigation/__init__.py` into minimal public API + separate dependency modules to reduce cross-module fan-in. |
| 5 | `bot/keyboards.py` has low cohesion and crosses presentation/data boundaries | P2 | `bot/keyboards.py:14`, `bot/keyboards.py:15`, `bot/keyboards.py:563`, `bot/keyboards.py:667`, `bot/keyboards.py:927`, `bot/keyboards.py:1811` | Split into focused modules: pure keyboard renderers, TOC/query assembly service, and progress-label helpers; pass precomputed DTO/view-model data into keyboard builders instead of DB session/model objects. |
